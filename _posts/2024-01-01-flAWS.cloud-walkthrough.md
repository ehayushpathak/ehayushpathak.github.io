---
title: "flAWS.cloud walkthrough"
date: 2024-01-01
categories: [AWS, Cloud, Security]
tags: [AWS, Security]
---

![flAWS](/images/flaws1/flaws.png) 

Hi there everyone, in this blog post I will write about how I approached and solved the OG flAWS challenge!

Before starting the challenge, make sure you have AWS CLI installed and configured.

## Level 1

The description of the challenge says "This level is *buckets* of fun. See if you can find the first sub-domain."

As the description mentions buckets, we know that this challenge is related to S3 buckets which is an object storage service from AWS, first we need to find the sub-domain, so let's turn on the hacker mode, jump right into our cool terminals, and fire up the CLI tools.

Let's first try to do some basic enumeration and run `dig flaws.cloud` to see what we can find.

![dig](/images/flaws1/level1/1.png)

After analyzing the output of the dig command, we run `nslookup` on the IP address we found with the "dig" command.

![nslookup](/images/flaws1/level1/2.png)  

Here, we see the domain name which tells us that the website is hosted on the S3 buckets. If we open this in our browser we will land up on the flaws.cloud website. 
So, now let's see what does this s3 bucket contains, we can do this by listing all the contents inside the flaws.cloud bucket with this command: `aws s3 ls s3://flaws.cloud`.\
Note: AWS S3 is a global service and all the bucket names have to be globally unique among all the AWS accounts.

![s3](/images/flaws1/level1/3.png)   

Among all the files in the bucket, the HTML file with secret as a prefix stands out so we will copy the name and append it to our challenge domain and open it in the browser "http://flaws.cloud/secret-dd02c7c.html" to complete the first challenge

![dig](/images/flaws1/level1/4.png)


## Level 2

Before jumping on to the next challenge, make sure you read and understand the "Lesson Learned" part.

The description of the Second challenge is "The next level is fairly similar, with a slight twist. You're going to need your own AWS account for this. You just need the [free tier](https://aws.amazon.com/s/dm/optimization/server-side-test/free-tier/free_np/)."

Since we already have aws cli configured we will try to access the S3 bucket similarly as we did in previous challenge with the command `aws s3 ls s3://level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud`

![](/images/flaws1/level2/1.png)

We see another secret file, similar to the Level1 Challenge, we will append this html file to the challenge URL and we successfully finished the second challenge here as well.

![](/images/flaws1/level2/2.png)

## Level 3

Description of the third challenge says "The next level is fairly similar, with a slight twist. Time to find your first AWS key! I bet you'll find something that will let you list what other buckets are."

So, we need to find the AWS Keys, lets download all the files of the Challenge3 bucket into our local system to check what it contains. We can download files from s3 bucket to our local computer with `aws s3 cp <filename> <destination>`, and to download all the files at once, we have to pass "--recursive" flag.\
Note: You can also use `aws s3 sync` command for this step. 

![](/images/flaws1/level3/2.png)

Now we have the files locally, we can start looking through files. In the folder we can see several files including hints, but ".git" folder looks interesting as it is tend to contain sensitive information, so let's check it out with `git log` command.

![](/images/flaws1/level3/3.png)

The commit messages gives us a hint that the developer might have pushed AWS keys into the first version, and removed them later. Since it is git, we can switch to the previous version easily so let's move to the previous version with `git checkout <commit-id>`. Now, when we list the contents we can see there is a file that contains the AWS Keys.

![](/images/flaws1/level3/4.png)

Let us configure our AWS cli with these newly found keys, we will create a new profile for this challenge with `aws configure --profile flaws`. After that, as mentioned in the challenge description we try to list what other buckets are available with `aws s3 ls --profile flaws`
We can now see the buckets for all the challenges. Let's now jump to level 4 in the browser.

![](/images/flaws1/level3/5.png)

## Level 4

Description of challenge 4 says "For the next level, you need to get access to the web page running on an EC2 at 4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud\
It'll be useful to know that a snapshot was made of that EC2 shortly after nginx was setup on it."

According to the description, we need to access the web page, but when we open the link in the browser we get popup for credentials.

![](/images/flaws1/level4/1.png)

Let's try to utilize the keys we found in the previous challenge and see what we can do with them. First to find basic information about the user of the keys, we will run `aws sts get-caller-identity`. You can think of this command as the `whoami` of AWS.\
Since the description mentioned 

![](/images/flaws1/level4/2.png)



![](/images/flaws1/level4/3.png)



![](/images/flaws1/level4/4.png)



![](/images/flaws1/level4/5.png)



![](/images/flaws1/level4/6.png)